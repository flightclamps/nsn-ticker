<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NSN SPORTS â€¢ Live Ticker</title>

<style>
  body {
    margin: 0;
    background: #000;
    overflow: hidden;
    font-family: Arial, sans-serif;
  }

  .nsn-bar {
    width: 100vw;
    height: 68px;
    background: #0a0a0a;
    border-top: 3px solid #1E88E5;
    border-bottom: 3px solid #1E88E5;
    display: flex;
    align-items: center;
  }

  .nsn-logo {
    width: 280px;
    height: 100%;
    background: linear-gradient(135deg, #1E88E5, #0d4d80);
    border-right: 3px solid white;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding-left: 12px;
    box-sizing: border-box;
  }
  .nsn-title {
    font-size: 22px;
    font-weight: 900;
    color: #fff;
  }
  .nsn-sub {
    font-size: 11px;
    color: #d6ecff;
  }
  .nsn-sponsor {
    font-size: 10px;
    color: #f7f7f7;
    opacity: 0.9;
    margin-top: 3px;
  }

  .scroll-area {
    flex: 1;
    overflow: hidden;
    position: relative;
  }

  .scroll-track {
    position: absolute;
    white-space: nowrap;
    font-size: 22px;
    font-weight: 600;
    color: #fff;
    padding-left: 100%;
    animation: scroll linear infinite;
  }

  .item {
    margin-right: 70px;
  }

  .label {
    color: #FFC107;
    font-weight: 900;
    margin-right: 10px;
  }

  @keyframes scroll {
    from { transform: translateX(0); }
    to   { transform: translateX(-100%); }
  }
</style>
</head>

<body>

<div class="nsn-bar">
  <div class="nsn-logo">
    <div class="nsn-title">NSN SPORTS</div>
    <div class="nsn-sub">NotSoNetwork â€¢ No Commercials</div>
    <div class="nsn-sponsor">Sponsored by: HYPE FUEL ENERGY</div>
  </div>

  <div class="scroll-area">
    <div class="scroll-track" id="track"></div>
  </div>
</div>

<script>
  // ==============================
  // SETTINGS / PROXY
  // ==============================
  const SPEED = 38;              // pixels per second
  const REFRESH_MS = 120000;     // 2 minutes
  const proxyBase = "https://api.allorigins.win/raw?url=";

  const track = document.getElementById("track");

  // ==============================
  // LIVE DATA SOURCES
  // ==============================

  // Scoreboards (ESPN JSON)
  const scoreboardSources = [
    { label: "NFL", url: proxyBase + encodeURIComponent("https://site.api.espn.com/apis/site/v2/sports/football/nfl/scoreboard") },
    { label: "NBA", url: proxyBase + encodeURIComponent("https://site.api.espn.com/apis/site/v2/sports/basketball/nba/scoreboard") },
    { label: "NHL", url: proxyBase + encodeURIComponent("https://site.api.espn.com/apis/site/v2/sports/hockey/nhl/scoreboard") },
    { label: "SOC", url: proxyBase + encodeURIComponent("https://site.api.espn.com/apis/site/v2/sports/soccer/scoreboard") },
    { label: "CFB", url: proxyBase + encodeURIComponent("https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard") }
  ];

  // Rankings (best-effort AP via ESPN)
  const rankingSources = [
    { label: "CFB AP", url: proxyBase + encodeURIComponent("https://site.web.api.espn.com/apis/v2/sports/football/college-football/rankings") },
    { label: "CBB AP", url: proxyBase + encodeURIComponent("https://site.web.api.espn.com/apis/v2/sports/basketball/mens-college-basketball/rankings") }
  ];

  // News / Rumors (RSS)
  const newsFeeds = [
    proxyBase + encodeURIComponent("https://www.espn.com/espn/rss/news"),
    proxyBase + encodeURIComponent("https://sports.yahoo.com/rss/"),
    proxyBase + encodeURIComponent("https://www.cbssports.com/rss/headlines/")
  ];

  // ==============================
  // STREAM ENGAGEMENT (OK TO BE STATIC TEXT)
  // ==============================
  const engagementLines = [
    "WELCOME TO NSN SPORTS â€¢ DROP YOUR FAVORITE TEAM IN CHAT",
    "ðŸ”¥ LIKE THE STREAM â€¢ HIT FOLLOW â€¢ SHARE WITH A FRIEND",
    "JOIN THE CLUB FOR 1 COIN!!!!! â€¢ GET YOUR NAME ON THE BOARD",
    "SONG REQUESTS: !play Song - Artist â€¢ LET CHAT CONTROL THE VIBES",
    "NO COMMERCIALS â€¢ LIVE SPORTS TALK ALL STREAM â€¢ STAY LOCKED",
    "FIRST TIME VIEWER? SAY HI IN CHAT â€¢ OGâ€™S DROP YOUR DAY ONE EMOTE"
  ];

  const teamPrompts = [
    "COWBOYS â€¢ WHAT'S YOUR REAL SEASON RECORD PREDICTION?",
    "CHIEFS â€¢ IS THIS STILL A DYNASTY OR ARE TEAMS CATCHING UP?",
    "EAGLES â€¢ WHAT IS THE BIGGEST NEED RIGHT NOW?",
    "49ERS â€¢ WHO IS THE TRUE MVP OF THIS ROSTER?",
    "LAKERS â€¢ ARE YOU TITLE READY OR ONE PIECE AWAY?",
    "CELTICS â€¢ WHO IS YOUR X-FACTOR IN THE PLAYOFFS?",
    "WARRIORS â€¢ HOW MANY PRIME YEARS DOES CURRY HAVE LEFT?",
    "MAVS â€¢ HOW FAR CAN LUKA TAKE THIS CORE?",
    "CFB â€¢ WHO IS YOUR TRUE #1 RIGHT NOW?",
    "PREMIER LEAGUE â€¢ WHO IS YOUR FAVORITE CLUB?"
  ];

  const fanQuestions = [
    "NFL FANS: WHO IS THE MOST UNDERRATED QB IN THE LEAGUE?",
    "NBA FANS: WHO IS YOUR DARK HORSE TITLE TEAM?",
    "CFB FANS: WHO IS THE MOST OVERHYPED PROGRAM?",
    "SOCCER FANS: WHO IS THE BEST CLUB IN THE WORLD RIGHT NOW?",
    "PREMIER LEAGUE FANS: WHO FINISHES TOP FOUR?",
    "NHL FANS: WHICH GOALIE DO YOU TRUST IN GAME 7?",
    "COWBOYS FANS: HOW MANY PLAYOFF WINS DO YOU EXPECT?",
    "LAKERS FANS: MORE SHOOTING OR MORE DEFENSE?",
    "MAVS FANS: WHAT DOES LUKA NEED AROUND HIM?",
    "SPURS FANS: WHAT IS WEMBY'S REALISTIC CEILING?"
  ];

  // ==============================
  // HELPERS
  // ==============================
  function shuffle(arr) {
    const a = arr.slice();
    for (let i = a.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      const tmp = a[i];
      a[i] = a[j];
      a[j] = tmp;
    }
    return a;
  }

  function addItem(text, label) {
    const span = document.createElement("span");
    span.className = "item";
    span.innerHTML = '<span class="label">' + label + '</span>' + text;
    track.appendChild(span);
  }

  // ==============================
  // LIVE SCORES (FINAL or IN-PROGRESS)
  // ==============================
  async function addScores() {
    for (const src of scoreboardSources) {
      try {
        const res = await fetch(src.url);
        const data = await res.json();
        const events = (data && data.events) ? data.events : [];
        let added = 0;

        for (let i = 0; i < events.length && added < 5; i++) {
          const ev = events[i];
          if (!ev || !ev.competitions || ev.competitions.length === 0) continue;
          const comp = ev.competitions[0];
          if (!comp || !comp.competitors || comp.competitors.length < 2) continue;

          const statusObj = ev.status && ev.status.type ? ev.status.type : null;
          const desc = statusObj && statusObj.description ? statusObj.description.toLowerCase() : "";
          const short = statusObj && statusObj.shortDetail ? statusObj.shortDetail : "";
          const isFinal = statusObj && (statusObj.completed || desc.indexOf("final") !== -1);

          const c1 = comp.competitors[0];
          const c2 = comp.competitors[1];

          function getName(c) {
            if (!c) return "TEAM";
            if (c.team) {
              return c.team.abbreviation || c.team.shortDisplayName || c.team.name || "TEAM";
            }
            return c.displayName || "TEAM";
          }

          const t1 = getName(c1);
          const t2 = getName(c2);
          const s1 = c1 && c1.score ? c1.score : "0";
          const s2 = c2 && c2.score ? c2.score : "0";

          const label = isFinal ? (src.label + " FINAL") : (src.label + " LIVE");
          const extra = short ? " â€¢ " + short : "";

          addItem(t1 + " " + s1 + " â€¢ " + t2 + " " + s2 + extra, label);
          added++;
        }
      } catch (e) {
        console.log("Score error:", src.label, e);
      }
    }
  }

  // ==============================
  // LIVE RANKINGS (AP via ESPN, best-effort)
  // ==============================
  async function addRankings() {
    for (const src of rankingSources) {
      try {
        const res = await fetch(src.url);
        const data = await res.json();
        let polls = [];

        // Try multiple possible shapes to be safe
        if (data && Array.isArray(data.rankings)) {
          polls = data.rankings;
        } else if (data && Array.isArray(data.items)) {
          polls = data.items;
        }

        if (!polls || polls.length === 0) continue;

        const poll = polls[0]; // usually AP Top 25 is first
        let teams = [];

        if (poll.polls && poll.polls[0] && Array.isArray(poll.polls[0].ranks)) {
          teams = poll.polls[0].ranks;
        } else if (Array.isArray(poll.ranks)) {
          teams = poll.ranks;
        } else if (Array.isArray(poll.teams)) {
          teams = poll.teams;
        }

        if (!teams || teams.length === 0) continue;

        const maxTeams = Math.min(10, teams.length);
        const parts = [];

        for (let i = 0; i < maxTeams; i++) {
          const t = teams[i];
          const rank = t.rank || t.current || (i + 1);
          let name = "";

          if (t.team) {
            name = t.team.displayName || t.team.shortDisplayName || t.team.abbreviation || t.team.name || "";
          } else {
            name = t.displayName || t.shortDisplayName || t.abbreviation || t.name || "";
          }

          if (!name) continue;
          parts.push(rank + ". " + name);
        }

        if (parts.length > 0) {
          addItem(parts.join(" â€¢ "), src.label);
        }

      } catch (e) {
        console.log("Ranking error:", src.label, e);
      }
    }
  }

  // ==============================
  // LIVE NEWS + RUMORS (RSS)
  // ==============================
  async function addNewsAndRumors() {
    const parser = new DOMParser();
    const rumorKeywords = [
      "rumor", "rumour", "trade", "traded", "trading",
      "free agent", "free agency", "extension", "contract",
      "linked to", "talks", "interest in", "shopping", "signing"
    ];

    for (const feed of newsFeeds) {
      try {
        const res = await fetch(feed);
        const text = await res.text();
        const xml = parser.parseFromString(text, "text/xml");
        const items = Array.from(xml.querySelectorAll("item")).slice(0, 6);

        items.forEach(it => {
          const titleNode = it.querySelector("title");
          if (!titleNode) return;
          const title = titleNode.textContent ? titleNode.textContent.trim() : "";
          if (!title) return;

          const lower = title.toLowerCase();
          let isRumor = false;
          for (let i = 0; i < rumorKeywords.length; i++) {
            if (lower.indexOf(rumorKeywords[i]) !== -1) {
              isRumor = true;
              break;
            }
          }

          if (isRumor) {
            addItem(title, "RUMOR");
          } else {
            addItem(title, "NEWS");
          }
        });
      } catch (e) {
        console.log("News error:", feed, e);
      }
    }
  }

  // ==============================
  // STREAM HOOKS / CHAT PROMPTS
  // ==============================
  function addEngagement() {
    engagementLines.forEach(line => addItem(line, "NSN"));
    teamPrompts.forEach(p => addItem(p, "TEAM"));

    const shuffled = shuffle(fanQuestions);
    const slice = shuffled.slice(0, 6);
    slice.forEach(q => addItem(q, "CHAT"));
  }

  // ==============================
  // BUILD TICKER
  // ==============================
  async function buildTicker() {
    track.innerHTML = "";

    // 1) Engagement first so ticker is never empty
    addEngagement();

    // 2) Live scores
    await addScores();

    // 3) Live rankings
    await addRankings();

    // 4) Live news + auto-tagged rumors
    await addNewsAndRumors();

    // Duplicate content for seamless loop
    const cloneHTML = track.innerHTML;
    track.innerHTML += cloneHTML;

    // Constant-speed scroll
    setTimeout(() => {
      const width = track.scrollWidth || 1;
      const duration = width / SPEED;
      track.style.animationDuration = duration + "s";
    }, 80);
  }

  document.addEventListener("DOMContentLoaded", buildTicker);
  setInterval(buildTicker, REFRESH_MS);
</script>

</body>
</html>
