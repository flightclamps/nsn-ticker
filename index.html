<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NSN SPORTS • Live Ticker</title>

<style>
  body {
    margin: 0;
    background: #000;
    overflow: hidden;
    font-family: Arial, sans-serif;
  }

  .nsn-bar {
    width: 100vw;
    height: 70px;
    background: #050505;
    border-top: 3px solid #1E88E5;
    border-bottom: 3px solid #FF3D00;
    display: flex;
    align-items: center;
  }

  .nsn-logo {
    width: 300px;
    height: 100%;
    background: linear-gradient(135deg, #1E88E5, #0d4d80);
    border-right: 3px solid #ffffff;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding-left: 14px;
  }

  .nsn-title {
    font-size: 22px;
    font-weight: 900;
    color: #fff;
  }

  .nsn-sub {
    font-size: 11px;
    color: #d6ecff;
  }

  .nsn-sponsor {
    font-size: 10px;
    color: #ffe0b2;
    margin-top: 3px;
  }

  .scroll-area {
    flex: 1;
    overflow: hidden;
    position: relative;
  }

  .scroll-track {
    position: absolute;
    white-space: nowrap;
    font-size: 22px;
    font-weight: 600;
    color: #fff;
    will-change: transform;
  }

  .label {
    color: #FFC107;
    font-weight: 900;
    margin-right: 10px;
  }
  .label-live { color: #4CAF50; }
  .label-final { color: #FFC107; }
  .label-upcoming { color: #29B6F6; }

  .item {
    margin-right: 70px;
  }
</style>
</head>

<body>

<div class="nsn-bar">
  <div class="nsn-logo">
    <div class="nsn-title">NSN SPORTS</div>
    <div class="nsn-sub">Live • Daily Coverage</div>
    <div class="nsn-sponsor">Powered by NSN Members</div>
  </div>

  <div class="scroll-area">
    <div class="scroll-track" id="track"></div>
  </div>
</div>

<script>
  // ============ SETTINGS ============
  const SPEED = 250; // pixels per second
  const proxy = "https://api.allorigins.win/raw?url=";

  const track = document.getElementById("track");
  const scrollArea = document.querySelector(".scroll-area");

  const sources = [
    { label: "NFL", url: "https://site.api.espn.com/apis/site/v2/sports/football/nfl/scoreboard" },
    { label: "NBA", url: "https://site.api.espn.com/apis/site/v2/sports/basketball/nba/scoreboard" },
    { label: "NHL", url: "https://site.api.espn.com/apis/site/v2/sports/hockey/nhl/scoreboard" },
    { label: "MLB", url: "https://site.api.espn.com/apis/site/v2/sports/baseball/mlb/scoreboard" },
    { label: "CFB", url: "https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard" }
  ].map(s => ({ label: s.label, url: proxy + encodeURIComponent(s.url) }));

  const questions = [
    "NFL FANS: WHO WINS TONIGHT?",
    "NBA FANS: WHO IS YOUR MVP RIGHT NOW?",
    "CFB FANS: WHO IS THE TRUE NO. 1?",
    "NHL FANS: WHICH TEAM IS ON TOP?",
    "DROP YOUR FAVORITE TEAM IN CHAT",
    "LIKE + FOLLOW FOR DAILY NSN UPDATES"
  ];

  function addItem(label, text, cls) {
    const span = document.createElement("span");
    let lab = "label";
    if (cls) lab += " " + cls;
    span.className = "item";
    span.innerHTML = `<span class="${lab}">${label}</span>${text}`;
    track.appendChild(span);
  }

  function shuffle(a) {
    return a.map(v => [Math.random(), v]).sort().map(pair => pair[1]);
  }

  function formatTime(dateStr) {
    try {
      let d = new Date(dateStr);
      return d.toLocaleTimeString("en-US", { hour: "numeric", minute: "2-digit" });
    } catch {
      return "";
    }
  }

  async function addScores() {
    for (let src of sources) {
      try {
        const res = await fetch(src.url);
        const data = await res.json();
        const events = (data && data.events) ? data.events : [];

        let count = 0;
        for (let ev of events) {
          if (count >= 4) break;

          const comp = ev.competitions?.[0];
          if (!comp || comp.competitors.length < 2) continue;

          const s = ev.status?.type || {};
          const desc = (s.description || "").toLowerCase();
          const state = (s.state || "").toLowerCase();
          const isFinal = s.completed || desc.includes("final");
          const isLive = state.includes("in") || desc.includes("live");

          const c1 = comp.competitors[0];
          const c2 = comp.competitors[1];

          const t1 = c1.team?.abbreviation || c1.team?.shortDisplayName || "TEAM1";
          const t2 = c2.team?.abbreviation || c2.team?.shortDisplayName || "TEAM2";

          if (isFinal) {
            addItem(src.label + " FINAL", `${t1} ${c1.score} • ${t2} ${c2.score}`, "label-final");
          } else if (isLive) {
            addItem(src.label + " LIVE", `${t1} ${c1.score} • ${t2} ${c2.score}`, "label-live");
          } else {
            const time = formatTime(ev.date);
            addItem(src.label + " TODAY", `${t1} @ ${t2} • ${time}`, "label-upcoming");
          }

          count++;
        }

      } catch (e) {
        console.log("error scoreboard", src.label, e);
      }
    }
  }

  async function addDate() {
    const d = new Date();
    const text = d.toLocaleDateString("en-US", {
      weekday: "short",
      month: "short",
      day: "numeric",
      year: "numeric"
    });
    addItem("DATE", text, "");
  }

  async function addQuestions() {
    shuffle(questions).slice(0, 5).forEach(q => {
      addItem("CHAT", q, "");
    });
  }

  async function build() {
    track.innerHTML = "";

    await addDate();
    await addQuestions();
    await addScores();

    // Duplicate for smooth loop
    track.innerHTML += track.innerHTML;
  }

  async function startScrolling() {
    while (true) {
      await build();

      let x = scrollArea.offsetWidth;
      let totalWidth = track.scrollWidth;

      // requestAnimationFrame loop
      await new Promise(resolve => {
        let last = null;
        function step(ts) {
          if (!last) last = ts;
          let dt = (ts - last) / 1000;
          last = ts;

          x -= SPEED * dt;
          track.style.transform = `translateX(${x}px)`;

          if (x <= -totalWidth) {
            resolve();
            return;
          }
          requestAnimationFrame(step);
        }
        requestAnimationFrame(step);
      });
    }
  }

  document.addEventListener("DOMContentLoaded", startScrolling);
</script>

</body>
</html>
