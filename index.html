<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NSN ELITE PERMANENT TICKER</title>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;500;600;700&family=Teko:wght@300;400;500;600;700&family=Rajdhani:wght@500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- CORE VARIABLES --- */
        :root {
            --brand-blue: #00f2ff;
            --brand-dark: #02040a;
            --brand-glass: rgba(10, 15, 25, 0.95);
            --brand-border: rgba(255, 255, 255, 0.1);
            --brand-gold: #ffd700;
            --brand-red: #ff004c;
            --brand-green: #00ff88;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background-color: transparent; /* Transparent for OBS */
            font-family: 'Chakra Petch', sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            color: white;
            text-transform: uppercase;
        }

        /* --- COSMIC BACKGROUND (Only covers ticker area visually) --- */
        .cosmos-container {
            position: fixed;
            top: 0; left: 0; 
            width: 100%; 
            height: 120px; /* Constrained to top area */
            background: radial-gradient(circle at 50% 0%, #1a0b2e 0%, #000000 80%);
            border-bottom: 1px solid var(--brand-blue);
            box-shadow: 0 0 20px rgba(0, 242, 255, 0.2);
            z-index: 0;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle var(--duration) ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.2; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        /* --- MAIN LAYOUT --- */
        .ticker-interface {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 120px;
            display: flex;
            z-index: 10;
        }

        /* --- LEFT: LOGO --- */
        .logo-zone {
            width: 130px;
            background: linear-gradient(160deg, #000 40%, #0a1a30 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-right: 3px solid var(--brand-blue);
            clip-path: polygon(0 0, 100% 0, 100% 100%, 0% 100%);
            z-index: 20;
        }

        .logo-text {
            font-family: 'Teko', sans-serif;
            font-size: 42px;
            font-weight: 700;
            line-height: 0.8;
            color: #fff;
            text-shadow: 0 0 10px var(--brand-blue);
        }
        
        .logo-sub {
            font-size: 9px;
            color: var(--brand-blue);
            letter-spacing: 2px;
            margin-top: 4px;
            font-weight: 700;
        }

        /* --- CENTER: DATA FEEDS --- */
        .feed-zone {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Top Line: Scores/Stats */
        .feed-primary {
            height: 75px;
            background: rgba(0, 5, 10, 0.6);
            display: flex;
            align-items: center;
            overflow: hidden;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(5px);
        }

        /* Bottom Line: News/Engagement */
        .feed-secondary {
            height: 45px;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            overflow: hidden;
        }

        /* Scrolling Animation */
        .scroll-track {
            display: flex;
            align-items: center;
            white-space: nowrap;
            will-change: transform;
            padding-left: 100%; /* Start off-screen */
        }

        .track-scores { animation: scroll-left 60s linear infinite; }
        .track-news { animation: scroll-left 45s linear infinite; }

        /* Speed adjustments based on content length can be handled in CSS or just set a safe slow speed */
        @keyframes scroll-left {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }

        /* --- GAME CARD STYLING --- */
        .game-card {
            display: inline-flex;
            align-items: center;
            height: 50px;
            margin-right: 60px;
            padding-right: 20px;
            border-right: 1px solid rgba(255,255,255,0.1);
            font-family: 'Rajdhani', sans-serif;
        }

        .league-tag {
            padding: 2px 6px;
            font-weight: 800;
            font-size: 14px;
            border-radius: 3px;
            margin-right: 12px;
            min-width: 40px;
            text-align: center;
            color: #fff;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }
        /* League Colors */
        .nfl { background: #013369; border: 1px solid #aaa; }
        .nba { background: #C9082A; border: 1px solid #aaa; }
        .mlb { background: #002D72; border: 1px solid #aaa; }
        .nhl { background: #111; border: 1px solid #fff; }
        .cfb { background: #7B6545; }

        .match-info {
            display: flex;
            align-items: center;
            font-size: 22px;
            font-weight: 700;
        }

        .score {
            color: #fff;
            margin: 0 6px;
            font-size: 26px;
            font-family: 'Teko', sans-serif;
        }
        
        .vs {
            color: #888;
            font-size: 14px;
            margin: 0 8px;
            font-weight: 600;
        }

        /* Live Indicator */
        .status-live {
            color: var(--brand-red);
            font-size: 12px;
            font-weight: 800;
            margin-left: 8px;
            animation: pulse-red 1.5s infinite;
            border: 1px solid var(--brand-red);
            padding: 1px 4px;
            border-radius: 2px;
        }

        /* Player Stats Box */
        .stat-box {
            margin-left: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-left: 2px solid var(--brand-gold);
            padding-left: 8px;
            height: 34px;
        }
        
        .stat-player { font-size: 11px; color: #ccc; line-height: 1; font-weight: 600; }
        .stat-val { font-size: 14px; color: var(--brand-gold); font-weight: 700; line-height: 1; margin-top: 2px; }

        /* --- NEWS & ENGAGEMENT --- */
        .news-item {
            margin-right: 50px;
            font-size: 16px;
            color: #ddd;
            display: flex;
            align-items: center;
        }
        
        .news-badge {
            background: #333;
            color: #aaa;
            font-size: 10px;
            padding: 2px 5px;
            margin-right: 8px;
            border-radius: 2px;
        }

        .engage-item {
            color: var(--brand-gold);
            font-weight: 700;
            font-size: 18px;
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.4);
            display: flex;
            align-items: center;
        }
        
        .engage-icon { margin-right: 8px; font-size: 20px; }

        /* --- RIGHT: CLOCK --- */
        .clock-zone {
            width: 120px;
            background: #111;
            border-left: 3px solid var(--brand-blue);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
        }

        #time-display {
            font-family: 'Teko', sans-serif;
            font-size: 34px;
            font-weight: 600;
            color: #fff;
        }
        
        #date-display {
            font-size: 11px;
            color: var(--brand-blue);
            font-weight: 700;
        }

        @keyframes pulse-red { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

    </style>
</head>
<body>

    <div class="cosmos-container" id="stars"></div>

    <div class="ticker-interface">
        <!-- LOGO -->
        <div class="logo-zone">
            <div class="logo-text">NSN</div>
            <div class="logo-sub">LIVE FEED</div>
        </div>

        <!-- FEED -->
        <div class="feed-zone">
            <div class="feed-primary">
                <div class="scroll-track track-scores" id="score-track">
                    <div class="game-card">LOADING SPORTS DATA...</div>
                </div>
            </div>
            <div class="feed-secondary">
                <div class="scroll-track track-news" id="news-track">
                    <div class="news-item">INITIALIZING NEWS STREAM...</div>
                </div>
            </div>
        </div>

        <!-- CLOCK -->
        <div class="clock-zone">
            <div id="time-display">--:--</div>
            <div id="date-display">--/--</div>
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        // Proxy is essential for browser-based CORS requests to ESPN
        const PROXY = "https://corsproxy.io/?"; 
        const REFRESH_MS = 60000; // 1 Minute Refresh

        // --- STAR GENERATOR ---
        function initStars() {
            const container = document.getElementById('stars');
            for(let i=0; i<60; i++){
                let s = document.createElement('div');
                s.className = 'star';
                s.style.left = Math.random()*100 + '%';
                s.style.top = Math.random()*100 + '%';
                s.style.width = Math.random()*3 + 'px';
                s.style.height = s.style.width;
                s.style.setProperty('--duration', (2+Math.random()*3)+'s');
                container.appendChild(s);
            }
        }
        initStars();

        // --- API HELPERS ---
        async function fetchData(url) {
            try {
                const res = await fetch(PROXY + encodeURIComponent(url));
                if(res.ok) return await res.json();
            } catch(e) { console.error("Fetch error:", e); }
            return null;
        }

        // --- DATA PARSER ---
        function buildGameCard(league, event) {
            const comp = event.competitions[0];
            const h = comp.competitors.find(c => c.homeAway === 'home');
            const a = comp.competitors.find(c => c.homeAway === 'away');
            const status = event.status.type.state; // pre, in, post
            
            let scoreHTML = "";
            let statHTML = "";
            
            // 1. STATUS & SCORES
            if (status === 'in') {
                // LIVE GAME
                scoreHTML = `
                    ${a.team.abbreviation} <span class="score">${a.score}</span> 
                    <span class="status-live">LIVE</span> 
                    <span class="score">${h.score}</span> ${h.team.abbreviation}
                `;
            } else if (status === 'post') {
                // FINISHED GAME
                scoreHTML = `
                    ${a.team.abbreviation} <span class="score">${a.score}</span> 
                    <span class="vs">F</span> 
                    <span class="score">${h.score}</span> ${h.team.abbreviation}
                `;
            } else {
                // UPCOMING
                const date = new Date(event.date);
                const time = date.toLocaleTimeString([], {hour:'numeric', minute:'2-digit'});
                scoreHTML = `
                    ${a.team.abbreviation} <span class="vs">vs</span> ${h.team.abbreviation} 
                    <span class="vs" style="color:var(--brand-blue)">${time}</span>
                `;
            }

            // 2. STATS / LEADERS (The "Best Players" logic)
            // ESPN often puts leaders in competitions[0].leaders
            if (comp.leaders && comp.leaders.length > 0) {
                const l = comp.leaders[comp.leaders.length - 1]; // Usually the most relevant category
                const player = l.leaders[0].athlete.shortName;
                const val = l.leaders[0].displayValue;
                statHTML = `
                    <div class="stat-box">
                        <span class="stat-player">${player}</span>
                        <span class="stat-val">${val}</span>
                    </div>
                `;
            } else if (status === 'in' && a.team.abbreviation === 'LAL') {
                // Mock Stat for specific teams if API lacks depth in basic endpoint (Optional polish)
                // Keeping it clean: If no leader data, show nothing or show record
                const rec = h.records ? h.records[0].summary : "";
                if(rec) statHTML = `<div class="stat-box"><span class="stat-player">REC</span><span class="stat-val">${rec}</span></div>`;
            }

            return `
                <div class="game-card">
                    <span class="league-tag ${league.toLowerCase()}">${league}</span>
                    <div class="match-info">${scoreHTML}</div>
                    ${statHTML}
                </div>
            `;
        }

        // --- MAIN ENGINE ---
        async function updateTicker() {
            // 1. Get Dates
            // ESPN defaults to "current/upcoming" if no date passed, but passing today ensures valid schedule
            const today = new Date().toISOString().slice(0,10).replace(/-/g, ""); // YYYYMMDD

            // 2. Define Endpoints
            const sports = [
                { tag: "NFL", url: `https://site.api.espn.com/apis/site/v2/sports/football/nfl/scoreboard` },
                { tag: "NBA", url: `https://site.api.espn.com/apis/site/v2/sports/basketball/nba/scoreboard` },
                { tag: "MLB", url: `https://site.api.espn.com/apis/site/v2/sports/baseball/mlb/scoreboard` },
                { tag: "NHL", url: `https://site.api.espn.com/apis/site/v2/sports/hockey/nhl/scoreboard` }
            ];

            let allGamesHTML = "";

            // 3. Fetch Loop
            for (const sport of sports) {
                const data = await fetchData(sport.url);
                if (data && data.events) {
                    // Limit to 4 games per sport to keep loop manageable
                    data.events.slice(0, 4).forEach(event => {
                        allGamesHTML += buildGameCard(sport.tag, event);
                    });
                }
            }

            if (allGamesHTML === "") {
                allGamesHTML = `<div class="game-card" style="width:400px">NO LIVE GAMES SCHEDULED FOR TODAY - CHECKING UPCOMING...</div>`;
            }

            // 4. Update DOM (Triple content for smooth loop)
            const track = document.getElementById('score-track');
            // Only update if content changed to prevent jumpiness
            if (!track.dataset.loaded || track.dataset.loaded === "false") {
                track.innerHTML = allGamesHTML + allGamesHTML + allGamesHTML;
                track.dataset.loaded = "true"; // Simple lock, better logic would diff check
            } else {
                // For updates, we might want to be careful not to reset animation
                // For this simple version, we just replace.
                track.innerHTML = allGamesHTML + allGamesHTML + allGamesHTML;
            }

            // 5. News & Engagement Mixed
            updateNews();
        }

        async function updateNews() {
            // Fetch NBA News as generic sports filler
            const newsData = await fetchData("https://site.api.espn.com/apis/site/v2/sports/basketball/nba/news");
            let items = [];
            
            if(newsData && newsData.articles) {
                newsData.articles.slice(0,3).forEach(a => {
                    items.push(`<div class="news-item"><span class="news-badge">NEWS</span> ${a.headline}</div>`);
                });
            }

            // ENGAGEMENT HOOKS
            const hooks = [
                `<div class="news-item engage-item"><span class="engage-icon">‚≠êÔ∏è</span> FOLLOW NotSoCj‚≠êÔ∏è NOW</div>`,
                `<div class="news-item engage-item"><span class="engage-icon">üéÅ</span> SEND A GIFT = SHOUTOUT</div>`,
                `<div class="news-item engage-item"><span class="engage-icon">üî•</span> TAP THE SCREEN</div>`
            ];

            // Mix them: News, Hook, News, Hook
            let finalHTML = "";
            let hookIdx = 0;
            
            if(items.length === 0) items.push(`<div class="news-item">Welcome to the Stream!</div>`);

            items.forEach(item => {
                finalHTML += item;
                if(hooks[hookIdx]) {
                    finalHTML += hooks[hookIdx];
                    hookIdx++;
                }
            });

            const track = document.getElementById('news-track');
            track.innerHTML = finalHTML + finalHTML + finalHTML;
        }

        // --- CLOCK ---
        function tickClock() {
            const now = new Date();
            document.getElementById('time-display').textContent = now.toLocaleTimeString([], {hour:'numeric', minute:'2-digit'});
            document.getElementById('date-display').textContent = now.toLocaleDateString([], {month:'short', day:'numeric'}).toUpperCase();
        }

        // --- INIT ---
        setInterval(tickClock, 1000);
        tickClock();
        updateTicker();
        setInterval(updateTicker, REFRESH_MS); // Auto-refresh data every minute

    </script>
</body>
</html>

