<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NSN COSMIC SPORTS TICKER</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&family=Exo+2:wght@600;700;800&display=swap" rel="stylesheet">

<style>
  /* --- CORE SETUP --- */
  body {
    margin: 0;
    background: transparent;
    overflow: hidden;
    font-family: 'Roboto Condensed', sans-serif;
  }

  /* --- COSMIC BACKGROUND --- */
  .space-bg {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: #000;
    overflow: hidden;
    z-index: 1;
  }
  
  .stars {
    position: absolute;
    width: 100%;
    height: 100%;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='200'%3E%3Crect width='400' height='200' fill='%23000020'/%3E%3Ccircle cx='20' cy='30' r='1' fill='white'/%3E%3Ccircle cx='60' cy='70' r='1.2' fill='white'/%3E%3Ccircle cx='100' cy='40' r='0.8' fill='white'/%3E%3Ccircle cx='140' cy='90' r='1.1' fill='white'/%3E%3Ccircle cx='180' cy='30' r='0.9' fill='white'/%3E%3Ccircle cx='220' cy='70' r='1' fill='white'/%3E%3Ccircle cx='260' cy='40' r='0.6' fill='white'/%3E%3Ccircle cx='300' cy='90' r='1.2' fill='white'/%3E%3Ccircle cx='340' cy='30' r='0.8' fill='white'/%3E%3Ccircle cx='380' cy='70' r='1' fill='white'/%3E%3Ccircle cx='40' cy='140' r='0.7' fill='white'/%3E%3Ccircle cx='80' cy='110' r='1.1' fill='white'/%3E%3Ccircle cx='120' cy='160' r='0.9' fill='white'/%3E%3Ccircle cx='160' cy='130' r='0.6' fill='white'/%3E%3Ccircle cx='200' cy='180' r='1.2' fill='white'/%3E%3Ccircle cx='240' cy='150' r='0.8' fill='white'/%3E%3Ccircle cx='280' cy='110' r='1' fill='white'/%3E%3Ccircle cx='320' cy='160' r='0.7' fill='white'/%3E%3Ccircle cx='360' cy='130' r='1.1' fill='white'/%3E%3C/svg%3E");
    background-size: 400px 200px;
    animation: twinkle 10s linear infinite alternate;
  }
  
  @keyframes twinkle {
    0% { opacity: 0.7; }
    50% { opacity: 1; }
    100% { opacity: 0.7; }
  }
  
  .nebula {
    position: absolute;
    width: 100%;
    height: 100%;
    background: radial-gradient(ellipse at center, rgba(25,0,100,0.3) 0%, rgba(25,0,100,0) 70%),
                radial-gradient(ellipse at 30% 40%, rgba(0,50,200,0.3) 0%, rgba(0,50,200,0) 70%),
                radial-gradient(ellipse at 70% 60%, rgba(50,0,150,0.3) 0%, rgba(50,0,150,0) 70%);
    opacity: 0.6;
    animation: nebula-drift 30s ease-in-out infinite alternate;
  }
  
  @keyframes nebula-drift {
    0% { background-position: 0% 0%; }
    100% { background-position: 100% 100%; }
  }
  
  .planet {
    position: absolute;
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #006699, #00264d);
    box-shadow: 0 0 20px rgba(0, 150, 255, 0.7);
    top: -40px;
    right: 10%;
    z-index: 2;
    animation: planet-orbit 60s linear infinite;
  }
  
  .planet::after {
    content: '';
    position: absolute;
    width: 100px;
    height: 15px;
    background: rgba(100, 200, 255, 0.1);
    border-radius: 50%;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) rotate(30deg);
  }
  
  @keyframes planet-orbit {
    0% { transform: translateY(-40px) rotate(0deg); }
    100% { transform: translateY(240px) rotate(360deg); }
  }
  
  .shooting-star {
    position: absolute;
    width: 150px;
    height: 2px;
    background: linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.8) 50%, rgba(255,255,255,0) 100%);
    z-index: 3;
    opacity: 0;
    transform-origin: 0 0;
    animation: shooting 8s linear infinite;
  }
  
  .shooting-star:nth-child(1) {
    top: 20%;
    left: 10%;
    animation-delay: 0s;
  }
  
  .shooting-star:nth-child(2) {
    top: 60%;
    left: 30%;
    animation-delay: 3s;
  }
  
  .shooting-star:nth-child(3) {
    top: 30%;
    left: 60%;
    animation-delay: 6s;
  }
  
  @keyframes shooting {
    0% { transform: translateX(0) translateY(0) rotate(35deg); opacity: 0; }
    5% { opacity: 1; }
    15% { transform: translateX(300px) translateY(300px) rotate(35deg); opacity: 0; }
    100% { opacity: 0; }
  }

  /* --- MAIN TICKER CONTAINER --- */
  .espn-ticker {
    width: 100vw;
    height: 70px;
    position: relative;
    z-index: 10;
    display: flex;
    overflow: hidden;
    box-shadow: 0 0 30px rgba(0, 100, 255, 0.5);
  }

  /* --- LEFT: LOGO AREA --- */
  .ticker-logo {
    width: 180px;
    min-width: 180px;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    border-right: 2px solid #0066cc;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
    z-index: 20;
  }
  
  .ticker-title {
    font-family: 'Exo 2', sans-serif;
    font-size: 28px;
    font-weight: 800;
    color: #ffffff;
    text-shadow: 0 0 10px rgba(0, 150, 255, 0.8);
    letter-spacing: -1px;
    white-space: nowrap;
    overflow: hidden;
    border-right: 3px solid #00a1ff;
    width: 0;
    animation: typing 3s steps(11, end) forwards, blink-caret 0.75s step-end infinite;
  }
  
  @keyframes typing {
    from { width: 0 }
    to { width: 160px }
  }
  
  @keyframes blink-caret {
    from, to { border-color: transparent }
    50% { border-color: #00a1ff }
  }
  
  .ticker-tagline {
    font-size: 10px;
    color: #7ad2ff;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-top: 6px;
  }

  /* --- RIGHT: MAIN CONTENT AREA --- */
  .ticker-content {
    flex: 1;
    height: 100%;
    position: relative;
    background-color: rgba(0, 0, 0, 0.85);
  }
  
  /* SportsCenter-style two-line format */
  .ticker-lines {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
  }
  
  .ticker-line {
    height: 50%;
    width: 100%;
    display: flex;
    align-items: center;
    overflow: hidden;
    position: relative;
  }
  
  .ticker-line:first-child {
    border-bottom: 1px solid #0066cc;
  }
  
  .line-items {
    position: absolute;
    display: flex;
    align-items: center;
    white-space: nowrap;
    left: 0;
    animation: scroll-line 30s linear infinite;
  }
  
  @keyframes scroll-line {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
  }
  
  .line-item {
    display: flex;
    align-items: center;
    margin-right: 40px;
    font-size: 18px;
    color: white;
  }
  
  /* League labels like SportsCenter */
  .league-label {
    background-color: #0066cc;
    color: white;
    font-weight: 700;
    padding: 2px 6px;
    margin-right: 10px;
    font-size: 14px;
  }
  
  /* Houston team highlight */
  .houston {
    color: #FF3E00;
    font-weight: 700;
    text-shadow: 0 0 5px rgba(255, 62, 0, 0.3);
  }
  
  /* Game status styles */
  .status {
    font-size: 12px;
    font-weight: 700;
    padding: 2px 5px;
    margin-left: 8px;
  }
  
  .status-live {
    background-color: #cc0000;
    color: white;
  }
  
  .status-final {
    background-color: #333;
    color: white;
  }
  
  /* Scores and teams */
  .team-name { font-weight: 700; }
  .score { font-weight: 700; margin: 0 4px; }
  .player-stat { color: #7ad2ff; margin-left: 10px; font-size: 16px; }
  
  /* Separator dot - SportsCenter style */
  .separator {
    width: 4px;
    height: 4px;
    background-color: #0066cc;
    border-radius: 50%;
    margin: 0 15px;
    display: inline-block;
  }
  
  /* --- RIGHT: CLOCK AREA --- */
  .ticker-clock {
    width: 110px;
    min-width: 110px;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    border-left: 2px solid #0066cc;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
    z-index: 20;
  }
  
  #clock-time {
    font-family: 'Exo 2', sans-serif;
    font-size: 22px;
    font-weight: 700;
    color: white;
    text-shadow: 0 0 8px rgba(0, 150, 255, 0.5);
  }
  
  #clock-date {
    font-size: 12px;
    color: #7ad2ff;
    font-weight: 700;
    margin-top: 2px;
  }
</style>
</head>

<body>

<!-- Space Background -->
<div class="space-bg">
  <div class="stars"></div>
  <div class="nebula"></div>
  <div class="planet"></div>
  <div class="shooting-star"></div>
  <div class="shooting-star"></div>
  <div class="shooting-star"></div>
</div>

<!-- Main Ticker -->
<div class="espn-ticker">
  
  <!-- Logo Area -->
  <div class="ticker-logo">
    <div class="ticker-title">NSN SPORTS</div>
    <div class="ticker-tagline">Powered by NotSoCj⭐️</div>
  </div>
  
  <!-- Content Area with Two Lines -->
  <div class="ticker-content">
    <div class="ticker-lines">
      <!-- Top Line -->
      <div class="ticker-line">
        <div class="line-items" id="line1">
          <!-- Line 1 content will be inserted here by JavaScript -->
        </div>
      </div>
      
      <!-- Bottom Line -->
      <div class="ticker-line">
        <div class="line-items" id="line2">
          <!-- Line 2 content will be inserted here by JavaScript -->
        </div>
      </div>
    </div>
  </div>
  
  <!-- Clock Area -->
  <div class="ticker-clock">
    <div id="clock-time">--:--</div>
    <div id="clock-date">--/--</div>
  </div>
  
</div>

<script>
  // ============ CONFIGURATION ============
  const PROXY_URLS = [
    "https://corsproxy.io/?",
    "https://api.allorigins.win/raw?url="
  ];
  
  const REFRESH_INTERVAL_MS = 120000; // 2 mins
  const HOUSTON_TEAMS = [
    "HOU", "Rockets", "Texans", "Astros", "Dynamo", "Dash", "Cougars", "Owls", "Houston"
  ];
  
  // ============ CLOCK ============
  function updateClock() {
    const now = new Date();
    const timeString = now.toLocaleTimeString("en-US", { hour: "numeric", minute: "2-digit" });
    const dateString = now.toLocaleDateString("en-US", { month: "short", day: "numeric" });
    document.getElementById('clock-time').textContent = timeString;
    document.getElementById('clock-date').textContent = dateString.toUpperCase();
  }
  setInterval(updateClock, 1000);
  updateClock();

  // ============ TYPEWRITER RESET ============
  function resetTypewriter() {
    const title = document.querySelector('.ticker-title');
    title.style.animation = 'none';
    void title.offsetWidth; // Trigger reflow
    title.style.animation = 'typing 3s steps(11, end) forwards, blink-caret 0.75s step-end infinite';
  }
  
  setInterval(resetTypewriter, 10000);

  // ============ DATA FETCHING ============
  async function fetchData(url) {
    for (let proxy of PROXY_URLS) {
      try {
        const res = await fetch(proxy + encodeURIComponent(url), { timeout: 5000 });
        if (res.ok) return await res.json();
      } catch (e) {
        console.log("Proxy failed, trying next");
      }
    }
    return { events: [] };
  }

  async function fetchText(url) {
    for (let proxy of PROXY_URLS) {
      try {
        const res = await fetch(proxy + encodeURIComponent(url), { timeout: 5000 });
        if (res.ok) return await res.text();
      } catch (e) {
        console.log("Proxy failed, trying next");
      }
    }
    return "";
  }

  // Check if a team is from Houston
  function isHoustonTeam(teamName) {
    return HOUSTON_TEAMS.some(name => teamName.includes(name));
  }

  // Sports Data Sources
  async function getSportsData() {
    const sources = [
      { league: "NFL", url: "https://site.api.espn.com/apis/site/v2/sports/football/nfl/scoreboard" },
      { league: "NBA", url: "https://site.api.espn.com/apis/site/v2/sports/basketball/nba/scoreboard" },
      { league: "MLB", url: "https://site.api.espn.com/apis/site/v2/sports/baseball/mlb/scoreboard" },
      { league: "NHL", url: "https://site.api.espn.com/apis/site/v2/sports/hockey/nhl/scoreboard" },
      { league: "CFB", url: "https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard?limit=25&groups=80" },
      { league: "CBB", url: "https://site.api.espn.com/apis/site/v2/sports/basketball/mens-college-basketball/scoreboard?limit=25&groups=50" }
    ];

    let items = [];
    
    for (const source of sources) {
      try {
        const data = await fetchData(source.url);
        const events = data.events || [];
        
        for (const ev of events.slice(0, 5)) {
          const comp = ev.competitions[0];
          const status = ev.status.type.state; // pre, in, post
          const detail = ev.status.type.shortDetail;
          
          if (comp.competitors && comp.competitors.length >= 2) {
            const home = comp.competitors.find(team => team.homeAway === "home") || comp.competitors[0];
            const away = comp.competitors.find(team => team.homeAway === "away") || comp.competitors[1];
            
            // Team names with rankings if available
            let homeName = home.team.abbreviation || home.team.shortDisplayName;
            let awayName = away.team.abbreviation || away.team.shortDisplayName;
            
            // Check for Houston teams
            const homeIsHouston = isHoustonTeam(home.team.displayName);
            const awayIsHouston = isHoustonTeam(away.team.displayName);
            
            if (home.curatedRank?.current <= 25) {
              homeName = `#${home.curatedRank.current} ${homeName}`;
            }
            
            if (away.curatedRank?.current <= 25) {
              awayName = `#${away.curatedRank.current} ${awayName}`;
            }
            
            const homeScore = home.score;
            const awayScore = away.score;
            
            // Format the HTML based on game status
            let statusHtml = "";
            let gameHtml = "";
            
            // Format the team names with Houston highlight
            const homeNameHtml = homeIsHouston ? 
              `<span class="houston">${homeName}</span>` : 
              `<span class="team-name">${homeName}</span>`;
              
            const awayNameHtml = awayIsHouston ? 
              `<span class="houston">${awayName}</span>` : 
              `<span class="team-name">${awayName}</span>`;
            
            if (status === "in") {
              statusHtml = `<span class="status status-live">LIVE</span>`;
              gameHtml = `${awayNameHtml} <span class="score">${awayScore}</span> @ ${homeNameHtml} <span class="score">${homeScore}</span> ${detail}`;
            } else if (status === "post") {
              statusHtml = `<span class="status status-final">FINAL</span>`;
              gameHtml = `${awayNameHtml} <span class="score">${awayScore}</span> @ ${homeNameHtml} <span class="score">${homeScore}</span>`;
            } else {
              gameHtml = `${awayNameHtml} @ ${homeNameHtml} ${detail}`;
            }
            
            // Get top performer if game is in progress or completed
            let playerStatsHtml = "";
            if ((status === "in" || status === "post") && comp.leaders && comp.leaders.length > 0 && comp.leaders[0].leaders && comp.leaders[0].leaders.length > 0) {
              const topCategory = comp.leaders[0];
              const topPlayer = topCategory.leaders[0];
              const playerName = topPlayer.athlete?.shortName || topPlayer.athlete?.displayName || "Player";
              const statValue = topPlayer.displayValue;
              const statName = topCategory.shortDisplayName || topCategory.displayName;
              
              playerStatsHtml = `<span class="player-stat">⭐ ${playerName}: ${statValue} ${statName}</span>`;
            }
            
            // SportsCenter style item
            items.push({
              html: `<span class="league-label">${source.league}</span> ${gameHtml} ${statusHtml} ${playerStatsHtml}`,
              priority: (homeIsHouston || awayIsHouston) ? 10 : 1, // Prioritize Houston teams
              status: status // To sort by game status
            });
          }
        }
      } catch (error) {
        console.error(`Error fetching ${source.league} data:`, error);
      }
    }
    
    // Sort items - Houston teams first, then LIVE games, then upcoming/completed
    items.sort((a, b) => {
      // Priority first (Houston teams)
      if (a.priority !== b.priority) return b.priority - a.priority;
      
      // Then by status (in > pre > post)
      if (a.status !== b.status) {
        if (a.status === "in") return -1;
        if (b.status === "in") return 1;
        if (a.status === "pre") return -1;
        if (b.status === "pre") return 1;
      }
      
      return 0;
    });
    
    return items.map(item => item.html);
  }

  // News Sources
  async function getSportsNews() {
    const sources = [
      { name: "ESPN", url: "https://www.espn.com/espn/rss/news" },
      { name: "CBS Sports", url: "https://www.cbssports.com/rss/headlines/" }
    ];
    
    let newsItems = [];
    const parser = new DOMParser();
    
    for (const source of sources) {
      try {
        const xmlStr = await fetchText(source.url);
        if (!xmlStr) continue;
        
        const xml = parser.parseFromString(xmlStr, "text/xml");
        const items = Array.from(xml.querySelectorAll("item")).slice(0, 3);
        
        for (const item of items) {
          const title = item.querySelector("title")?.textContent.replace("<![CDATA[", "").replace("]]>", "") || "";
          if (title) {
            // Check if news is about Houston teams
            const isHoustonNews = HOUSTON_TEAMS.some(team => title.includes(team));
            
            newsItems.push({
              html: `<span class="league-label">NEWS</span> ${title}`,
              priority: isHoustonNews ? 10 : 1 // Prioritize Houston news
            });
          }
        }
      } catch (error) {
        console.error(`Error fetching news from ${source.name}:`, error);
      }
    }
    
    // Sort by priority
    newsItems.sort((a, b) => b.priority - a.priority);
    
    return newsItems.map(item => item.html);
  }

  // Build the ticker content
  async function buildTicker() {
    try {
      // Get all data in parallel
      const [sportsData, newsData] = await Promise.all([
        getSportsData(),
        getSportsNews()
      ]);
      
      // If no data, show loading message
      if (sportsData.length === 0 && newsData.length === 0) {
        document.getElementById('line1').innerHTML = '<div class="line-item"><span class="league-label">INFO</span> Loading sports data... Please wait.</div>';
        document.getElementById('line2').innerHTML = '<div class="line-item"><span class="league-label">INFO</span> Connecting to sports networks...</div>';
        return;
      }
      
      // SportsCenter style - split content between two lines
      // Line 1: Scores and game updates
      // Line 2: News and additional info
      
      // Clear existing content
      document.getElementById('line1').innerHTML = '';
      document.getElementById('line2').innerHTML = '';
      
      // Build line 1 with scores
      let line1Html = '';
      for (let i = 0; i < sportsData.length; i++) {
        line1Html += `<div class="line-item">${sportsData[i]}`;
        
        // Add separator dot between items except last one
        if (i < sportsData.length - 1) {
          line1Html += `<span class="separator"></span>`;
        }
        
        line1Html += `</div>`;
      }
      
      // Build line 2 with news
      let line2Html = '';
      for (let i = 0; i < newsData.length; i++) {
        line2Html += `<div class="line-item">${newsData[i]}`;
        
        // Add separator dot between items except last one
        if (i < newsData.length - 1) {
          line2Html += `<span class="separator"></span>`;
        }
        
        line2Html += `</div>`;
      }
      
      // Update the DOM
      document.getElementById('line1').innerHTML = line1Html;
      document.getElementById('line2').innerHTML = line2Html;
      
      // Reset animations
      document.getElementById('line1').style.animation = 'none';
      document.getElementById('line2').style.animation = 'none';
      
      void document.getElementById('line1').offsetWidth; // Trigger reflow
      void document.getElementById('line2').offsetWidth; // Trigger reflow
      
      // Adjust animation duration based on content length
      const line1Width = document.getElementById('line1').scrollWidth;
      const line2Width = document.getElementById('line2').scrollWidth;
      const viewportWidth = window.innerWidth;
      
      const line1Duration = Math.max(30, line1Width / viewportWidth * 30);
      const line2Duration = Math.max(30, line2Width / viewportWidth * 30);
      
      document.getElementById('line1').style.animation = `scroll-line ${line1Duration}s linear infinite`;
      document.getElementById('line2').style.animation = `scroll-line ${line2Duration}s linear infinite`;
      
    } catch (error) {
      console.error("Error building ticker:", error);
      document.getElementById('line1').innerHTML = '<div class="line-item"><span class="league-label">ERROR</span> Unable to load data. Retrying...</div>';
    }
  }

  // Initialize
  buildTicker();
  setInterval(buildTicker, REFRESH_INTERVAL_MS);
  resetTypewriter();
</script>
</body>
</html>